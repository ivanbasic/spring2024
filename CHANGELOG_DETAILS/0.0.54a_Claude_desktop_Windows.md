# Claude Desktop Setup for Windows - File Sharing with MCP

## Overview
This guide covers setting up the Windows-MCP extension in Claude Desktop to enable file sharing and direct filesystem access.

## Prerequisites
- Windows 10/11
- Python 3.14 (or compatible version) - already installed
- Claude Desktop App - already installed and working

## Installation Steps

### 1. Install Windows-MCP Extension
1. Open Claude Desktop
2. Go to **Settings** ? **Extensions** ? **MCP**
3. Find and install **Windows-MCP** extension

### 2. Install UV Package Manager
The Windows-MCP extension requires `uv` (a Python package manager).

Open Command Prompt and run:
```cmd
pip install uv
```

Expected output:
```
Successfully installed uv-0.9.28
```

### 3. Add UV to System PATH
After installing `uv`, add it to your system PATH so Claude Desktop can find it.

Run this command in Command Prompt:
```cmd
setx PATH ""%PATH%;C:\Users\[YOUR_USERNAME]\AppData\Roaming\Python\Python314\Scripts""
```

**Important:** Replace `[YOUR_USERNAME]` with your actual Windows username.

To verify `uv` location, run:
```cmd
python -m pip show uv
```

Look for the `Location:` line to confirm the path.

### 4. Restart Everything
1. Close Command Prompt
2. **Completely close Claude Desktop** (check system tray)
3. **Restart your computer** (recommended) to ensure PATH changes take effect
4. Start Claude Desktop again

### 5. Verify Connection
1. Open Claude Desktop
2. Go to **Settings** ? **Extensions** ? **MCP**
3. Click **Configure** button next to Windows-MCP
4. Check **Tool permissions** - should show **read and write tool** (not an error message)

**Before fix:** Shows ""Unable to connect to extension server""  
**After fix:** Shows ""read and write tool"" permissions

## Troubleshooting

### Issue: ""uv is not recognized as an internal or external command""
**Solution:** 
- Verify `uv` is installed: `pip install uv`
- Add Scripts folder to PATH (see step 3)
- Restart computer

### Issue: Windows-MCP shows ""Unable to connect""
**Solution:**
- Check if `uv` is in PATH: run `where uv` in Command Prompt
- Disable and re-enable the extension in settings
- Check MCP log files for specific errors
- Restart Claude Desktop completely

### Finding Your uv Installation
Run this command to find where `uv` was installed:
```cmd
python -m pip show uv
```

The executable (`uv.exe`) will be in the `Scripts` subfolder of that location.

## Usage
Once connected, Claude can:
- Read files and folders from your computer
- List directory contents
- Access your project files directly
- Work with your codebase without manual file uploads

Example: Ask Claude to ""analyze my Spring project at C:\Users\ivan\jspring2024\spring2024""

## Notes
- This is a learning/development setup
- The Windows-MCP extension gives Claude access to your filesystem
- Always be mindful of what directories you're sharing
- For production use, consider more restricted access patterns

## References
- Claude Desktop: https://claude.ai
- MCP Documentation: https://modelcontextprotocol.io
- UV Package Manager: https://pypi.org/project/uv/
